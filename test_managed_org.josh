# Test: Explicitly manage organism collection at patch level

start unit count
end unit

start unit m
  alias meter
  alias meters
end unit

start simulation TestManaged
  grid.size = 10 m
  grid.low = 0 m latitude, 0 m longitude
  grid.high = 30 m latitude, 30 m longitude
  steps.low = 0 count
  steps.high = 10 count
  exportFiles.patch = "file:///workspace/results/test_managed_{replicate}.csv"
end simulation

start patch Default
  Thing.init = create Thing

  # Explicitly pass through organisms each step (like vegetation_model.josh does)
  Thing.step = prior.Thing

  export.sumAge.step = sum(Thing.age)
  export.thingCount.step = count(Thing)
end patch

start organism Thing
  age.init = 0 count
  age.step = prior.age + 1 count
end organism
