# Test: Store organism value in patch variable, then export

start unit count
end unit

start unit m
  alias meter
  alias meters
end unit

start simulation TestIndirect
  grid.size = 10 m
  grid.low = 0 m latitude, 0 m longitude
  grid.high = 30 m latitude, 30 m longitude
  steps.low = 0 count
  steps.high = 10 count
  exportFiles.patch = "file:///workspace/results/test_indirect_{replicate}.csv"
end simulation

start patch Default
  Thing.init = create Thing

  # Store the age from organism in a patch variable
  thingAge.init = Thing.age
  thingAge.step = Thing.age

  export.thingCount.step = count(Thing)
  export.thingAge.step = thingAge
end patch

start organism Thing
  age.init = 0 count
  age.step = prior.age + 1 count
end organism
